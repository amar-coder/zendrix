COde for feature 2 extended
